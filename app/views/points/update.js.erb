<%if (@point.errors.empty?) %>    

    var updateMarkerWithInfowindow = function () { 


        var marker_to_update = findById(<%=@point.id%>);


        var showUpdatedInfowinow = function() {
            openInfowindow(
                "<%= j(render :template => 'points/show.html.erb', 
                              :locals  => {:point => @point}) %>", 
                marker_to_update
            )
        };


        showUpdatedInfowinow();


        google.maps.event.addListener(marker_to_update, "click", function (e) {
            showUpdatedInfowinow();
        });     
        

  
        show_ajax_message("Yap! You updated it correctly","notice");
    }
    
    // Invoke it
    updateMarkerWithInfowindow();  
      
<%else%>

    // Notify user
    show_ajax_message("Errr, well, I could not update that. <%= j(raw(@point.errors.full_messages.join(','))) %>","error");

<%end%>